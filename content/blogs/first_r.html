---
categories:
- ""
- ""
date: "2017-10-31T22:26:09-05:00"
description: My first project in R
draft: false
#image: pic09.jpg
keywords: ""
slug: magna
title: My first project in R
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="task-1-biography" class="section level1">
<h1>Task 1: Biography</h1>
<div id="childhood" class="section level2">
<h2>Childhood</h2>
<p>My name is <strong>Leonie</strong> and I was born on 15.09.1998 in Cologne, Germany. My parents’ names are Ingo and Beate. I have one younger brother, Fabian, and he is born in 2001. I lived in Cologne my whole life until I went to university, except for 8 months in 10th grade, where I went to a boarding school in the US.</p>
</div>
<div id="hobbies" class="section level2">
<h2>Hobbies</h2>
<p>I have a lot of different interests and enjoy a lot of things:
* I have always had a creative side and when I was young, I used to draw and paint a lot and even visit art courses in my freetime.
* I like music and played various instruments growing up, amongst others I played the the piano for 8 years.
* While growing up, I did various sports on different levels:
+ My whole life, I have and still do play tennis. I enjoy it a lot and my favorite tennis players are Rafael Nadal and Roger Federer.
+ When I was little, I did trampoline for 4 years on a competitive level.
+ I ecentually quit trampoline when I was 11 to start allstar cheerleading. NOT on the side of football games. Here a demonstration what allstar cheerleading is: <a href="https://www.youtube.com/watch?v=a77FjRD58iQ">linked phase</a></p>
</div>
<div id="education" class="section level2">
<h2>Education</h2>
<p>After graduating high school in 2017, I started my undergraduate studies in Maastricht, the Netherlands, at Maastricht University. For my exchange semester I went to Nanyang Technological University in Singapore, which I loved a lot.</p>
<pre class="r"><code>knitr::include_graphics(&quot;/img/singa.jpg&quot;,error =FALSE)</code></pre>
<p><img src="/img/singa.jpg" /><!-- --></p>
<p>After taking a gap year for doing internships, I am now more than happy to start my Masters degree at LBS.</p>
</div>
</div>
<div id="task-2-country-comparison" class="section level1">
<h1>Task 2: Country comparison</h1>
<p>You have seen the <code>gapminder</code> dataset that has data on life expectancy, population, and GDP per capita for 142 countries from 1952 to 2007. To get a glimpse of the dataframe, namely to see the variable names, variable types, etc., we use the <code>glimpse</code> function. We also want to have a look at the first 20 rows of data.</p>
<pre class="r"><code>glimpse(gapminder)</code></pre>
<pre><code>## Rows: 1,704
## Columns: 6
## $ country   &lt;fct&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, &quot;Afghanistan&quot;, …
## $ continent &lt;fct&gt; Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, Asia, …
## $ year      &lt;int&gt; 1952, 1957, 1962, 1967, 1972, 1977, 1982, 1987, 1992, 1997, …
## $ lifeExp   &lt;dbl&gt; 28.801, 30.332, 31.997, 34.020, 36.088, 38.438, 39.854, 40.8…
## $ pop       &lt;int&gt; 8425333, 9240934, 10267083, 11537966, 13079460, 14880372, 12…
## $ gdpPercap &lt;dbl&gt; 779.4453, 820.8530, 853.1007, 836.1971, 739.9811, 786.1134, …</code></pre>
<pre class="r"><code>head(gapminder, 20) </code></pre>
<pre><code>## # A tibble: 20 × 6
##    country     continent  year lifeExp      pop gdpPercap
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.
##  2 Afghanistan Asia       1957    30.3  9240934      821.
##  3 Afghanistan Asia       1962    32.0 10267083      853.
##  4 Afghanistan Asia       1967    34.0 11537966      836.
##  5 Afghanistan Asia       1972    36.1 13079460      740.
##  6 Afghanistan Asia       1977    38.4 14880372      786.
##  7 Afghanistan Asia       1982    39.9 12881816      978.
##  8 Afghanistan Asia       1987    40.8 13867957      852.
##  9 Afghanistan Asia       1992    41.7 16317921      649.
## 10 Afghanistan Asia       1997    41.8 22227415      635.
## 11 Afghanistan Asia       2002    42.1 25268405      727.
## 12 Afghanistan Asia       2007    43.8 31889923      975.
## 13 Albania     Europe     1952    55.2  1282697     1601.
## 14 Albania     Europe     1957    59.3  1476505     1942.
## 15 Albania     Europe     1962    64.8  1728137     2313.
## 16 Albania     Europe     1967    66.2  1984060     2760.
## 17 Albania     Europe     1972    67.7  2263554     3313.
## 18 Albania     Europe     1977    68.9  2509048     3533.
## 19 Albania     Europe     1982    70.4  2780097     3631.
## 20 Albania     Europe     1987    72    3075321     3739.</code></pre>
<p>Your task is to produce two graphs of how life expectancy has changed over the years for the <code>country</code> and the <code>continent</code> you come from.</p>
<p>I have created the <code>country_data</code> and <code>continent_data</code> with the code below.</p>
<pre class="r"><code>country_data &lt;- gapminder %&gt;% 
            filter(country == &quot;Germany&quot;) 

continent_data &lt;- gapminder %&gt;% 
            filter(continent == &quot;Europe&quot;)</code></pre>
<p>First, create a plot of life expectancy over time for the single country you chose. Map <code>year</code> on the x-axis, and <code>lifeExp</code> on the y-axis. You should also use <code>geom_point()</code> to see the actual data points and <code>geom_smooth(se = FALSE)</code> to plot the underlying trendlines. You need to remove the comments <strong>#</strong> from the lines below for your code to run.</p>
<pre class="r"><code>plot1 &lt;- ggplot(country_data, aes(x = year, y = lifeExp))+
geom_point() +
geom_smooth(se = FALSE)+
NULL 

plot1</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/first_r_files/figure-html/lifeExp_one_country-1.png" width="672" /></p>
<p>Next we need to add a title. Create a new plot, or extend plot1, using the <code>labs()</code> function to add an informative title to the plot.</p>
<pre class="r"><code>plot1&lt;-plot1+labs(title=&quot;Life Expectancy in Germany from 1952-2007&quot;,x=&quot;Year&quot;,y=&quot;Life Expectancy&quot;)+NULL


plot1</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/first_r_files/figure-html/lifeExp_one_country_with_label-1.png" width="672" /></p>
<p>Secondly, produce a plot for all countries in the <em>continent</em> you come from. (Hint: map the <code>country</code> variable to the colour aesthetic. You also want to map <code>country</code> to the <code>group</code> aesthetic, so all points for each country are grouped together).</p>
<pre class="r"><code>ggplot(gapminder,aes(x=year,y=lifeExp,color=country,group=country))+geom_point()+geom_smooth(se=FALSE)+labs(title=&quot;Life Expectancy by Continent&quot;,x=&quot;Year&quot;,y=&quot;Life Expectancy&quot;)+NULL</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/first_r_files/figure-html/lifeExp_one_continent-1.png" width="672" /></p>
<p>Finally, using the original <code>gapminder</code> data, produce a life expectancy over time graph, grouped (or faceted) by continent. We will remove all legends, adding the <code>theme(legend.position="none")</code> in the end of our ggplot.</p>
<pre class="r"><code>ggplot(gapminder,aes(x=year,y=lifeExp,color=continent))+geom_line()+geom_smooth(se=FALSE)+facet_wrap(~continent)+theme(legend.position=&quot;none&quot;)+labs(title=&quot;Life Expectancy by Continent&quot;,x=&quot;Year&quot;,y=&quot;Life Expectancy&quot;)+NULL</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/first_r_files/figure-html/lifeExp_facet_by_continent-1.png" width="672" /></p>
<p>Given these trends, what can you say about life expectancy since 1952? Again, don’t just say what’s happening in the graph. Tell some sort of story and speculate about the differences in the patterns.</p>
<p>Overall, life expectancy has increased on all continents over the period from 1952 to 2007. The largest increases can be observed in Asia and the Americas. From 1952 to approximately 1985, Africa also experienced a steep increase in life expectancy, however, since 1985, it stagnated at around 54 years.
The reason why life expectancy is increasing is that the medical conditions and treatments as well as the living conditions from people across the globe are improving, which has a direct positive impact on the former. This improvement in conditions was (and still is) more significant in Asia and the Americas (which includes South America), as there was much more room for improvement due to the number of underdeveloped, developing, and emerging economies in these regions, in contrast to already very developed economies in Europe and Oceania (Australia and New Zealand). Even though North America is also very developed, it was most likely weighted down by the large number of people in South America. To get a better representation of the life expectancy of the two continents, it would be better to represent them separately.</p>
</div>
<div id="task-3-brexit-vote-analysis" class="section level1">
<h1>Task 3: Brexit vote analysis</h1>
<p>We will have a look at the results of the 2016 Brexit vote in the UK. First we read the data using <code>read_csv()</code> and have a quick glimpse at the data</p>
<pre class="r"><code>brexit_results &lt;- read_csv(here::here(&quot;data&quot;,&quot;brexit_results.csv&quot;))


glimpse(brexit_results)</code></pre>
<pre><code>## Rows: 632
## Columns: 11
## $ Seat        &lt;chr&gt; &quot;Aldershot&quot;, &quot;Aldridge-Brownhills&quot;, &quot;Altrincham and Sale W…
## $ con_2015    &lt;dbl&gt; 50.592, 52.050, 52.994, 43.979, 60.788, 22.418, 52.454, 22…
## $ lab_2015    &lt;dbl&gt; 18.333, 22.369, 26.686, 34.781, 11.197, 41.022, 18.441, 49…
## $ ld_2015     &lt;dbl&gt; 8.824, 3.367, 8.383, 2.975, 7.192, 14.828, 5.984, 2.423, 1…
## $ ukip_2015   &lt;dbl&gt; 17.867, 19.624, 8.011, 15.887, 14.438, 21.409, 18.821, 21.…
## $ leave_share &lt;dbl&gt; 57.89777, 67.79635, 38.58780, 65.29912, 49.70111, 70.47289…
## $ born_in_uk  &lt;dbl&gt; 83.10464, 96.12207, 90.48566, 97.30437, 93.33793, 96.96214…
## $ male        &lt;dbl&gt; 49.89896, 48.92951, 48.90621, 49.21657, 48.00189, 49.17185…
## $ unemployed  &lt;dbl&gt; 3.637000, 4.553607, 3.039963, 4.261173, 2.468100, 4.742731…
## $ degree      &lt;dbl&gt; 13.870661, 9.974114, 28.600135, 9.336294, 18.775591, 6.085…
## $ age_18to24  &lt;dbl&gt; 9.406093, 7.325850, 6.437453, 7.747801, 5.734730, 8.209863…</code></pre>
<p>The data comes from <a href="https://www.thecrosstab.com/">Elliott Morris</a>, who cleaned it and made it available through his <a href="https://www.datacamp.com/courses/analyzing-election-and-polling-data-in-r">DataCamp class on analysing election and polling data in R</a>.</p>
<p>Our main outcome variable (or y) is <code>leave_share</code>, which is the percent of votes cast in favour of Brexit, or leaving the EU. Each row is a UK <a href="https://en.wikipedia.org/wiki/United_Kingdom_Parliament_constituencies">parliament constituency</a>.
To get a sense of the spread, or distribution, of the data, we can plot a histogram, a density plot, and the empirical cumulative distribution function of the leave % in all constituencies.</p>
<pre class="r"><code>ggplot(brexit_results, aes(x = leave_share)) +
  geom_histogram(binwidth = 2.5)+labs(title=&quot;Brexit Voting Outcome&quot;,x=&quot;% votes for Brexit in the UK Constituency&quot;,y=&quot;Number of constituencies with that voting outcome&quot;)+NULL</code></pre>
<p><img src="/blogs/first_r_files/figure-html/brexit_histogram-1.png" width="672" /></p>
<pre class="r"><code>ggplot(brexit_results, aes(x = leave_share)) +
  geom_density()+labs(title=&quot;Brexit Voting Outcome&quot;,x=&quot;% votes for Brexit in the UK Constinuency&quot;,y=&quot;Density of constituencies with that voting outcome&quot;)+NULL</code></pre>
<p><img src="/blogs/first_r_files/figure-html/brexit_histogram-2.png" width="672" /></p>
<pre class="r"><code>ggplot(brexit_results, aes(x = leave_share)) +
  stat_ecdf(geom = &quot;step&quot;, pad = FALSE) +
  scale_y_continuous(labels = scales::percent)+labs(title=&quot;Brexit Voting Outcome&quot;,x=&quot;% votes for Brexit in the UK Constinuency&quot;,y=&quot;% of constituencies with that voting outcome&quot;)+NULL</code></pre>
<p><img src="/blogs/first_r_files/figure-html/brexit_histogram-3.png" width="672" /></p>
<p>One common explanation for the Brexit outcome was fear of immigration and opposition to the EU’s more open border policy. We can check the relationship (or correlation) between the proportion of native born residents (<code>born_in_uk</code>) in a constituency and its <code>leave_share</code>. To do this, let us get the correlation between the two variables</p>
<pre class="r"><code>brexit_results %&gt;% 
  select(leave_share, born_in_uk) %&gt;% 
  cor()</code></pre>
<pre><code>##             leave_share born_in_uk
## leave_share   1.0000000  0.4934295
## born_in_uk    0.4934295  1.0000000</code></pre>
<p>The correlation is almost 0.5, which shows that the two variables are positively correlated.</p>
<p>We can also create a scatterplot between these two variables using <code>geom_point</code>. We also add the best fit line, using <code>geom_smooth(method = "lm")</code>.</p>
<pre class="r"><code>ggplot(brexit_results, aes(x = born_in_uk, y = leave_share)) +
  geom_point(alpha=0.3) +
  geom_smooth(method = &quot;lm&quot;) + 
  theme_bw() +labs(title=&quot;Brexit Voting Outcome&quot;,x=&quot;Proportion of native borns residents in a constituency&quot;,y=&quot;% of votes for Brexit&quot;)+NULL</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="/blogs/first_r_files/figure-html/brexit_immigration_plot-1.png" width="672" /></p>
<p>What can you say about the relationship shown above? Again, don’t just say what’s happening in the graph. Tell some sort of story and speculate about the differences in the patterns.</p>
<p><strong>Histogram Brexit:</strong></p>
<ul>
<li>Contituencies with a percentage of votes in favor of Brexit of between 50-60% were most common</li>
<li>No constituencies voted 0% or 100% for Brexit</li>
<li>Slightly skewed to the left which means the center of the distribution is higher than 50%. This is accord with the outcome of the votum.</li>
</ul>
<p><strong>Density Function:</strong>
Constituencies with an outcome in favor of Brexit of 50-60% have the highest density (makes sense when looking at the histogram)</p>
<p><strong>Empirical cumulative distribution function:</strong></p>
<ul>
<li>In only 37.5% of the constituencies, the Brexit result was =&lt; 50% in favor of Brexit</li>
<li>The shape of the line is in accordance with the histogram and density function.A bit flatter at the beginning and becomes more steep as more constituencies voted “leave”.</li>
</ul>
<p><strong>Scatterplot:</strong></p>
<ul>
<li>The higher the proportion of people in a constituency that were native borns in the UK, the higher the respective percentage of votes in favor of Brexit in that constituency, hence, the upwards trend.</li>
</ul>
</div>
<div id="task-4-animal-rescue-incidents-attended-by-the-london-fire-brigade" class="section level1">
<h1>Task 4: Animal rescue incidents attended by the London Fire Brigade</h1>
<p><a href="https://data.london.gov.uk/dataset/animal-rescue-incidents-attended-by-lfb">The London Fire Brigade</a> attends a range of non-fire incidents (which we call ‘special services’). These ‘special services’ include assistance to animals that may be trapped or in distress. The data is provided from January 2009 and is updated monthly. A range of information is supplied for each incident including some location information (postcode, borough, ward), as well as the data/time of the incidents. We do not routinely record data about animal deaths or injuries.</p>
<p>Please note that any cost included is a notional cost calculated based on the length of time rounded up to the nearest hour spent by Pump, Aerial and FRU appliances at the incident and charged at the current Brigade hourly rate.</p>
<pre class="r"><code>url &lt;- &quot;https://data.london.gov.uk/download/animal-rescue-incidents-attended-by-lfb/8a7d91c2-9aec-4bde-937a-3998f4717cd8/Animal%20Rescue%20incidents%20attended%20by%20LFB%20from%20Jan%202009.csv&quot;

animal_rescue &lt;- read_csv(url,
                          locale = locale(encoding = &quot;CP1252&quot;)) %&gt;% 
  janitor::clean_names()


glimpse(animal_rescue)</code></pre>
<pre><code>## Rows: 7,951
## Columns: 31
## $ incident_number               &lt;chr&gt; &quot;139091&quot;, &quot;275091&quot;, &quot;2075091&quot;, &quot;2872091&quot;…
## $ date_time_of_call             &lt;chr&gt; &quot;01/01/2009 03:01&quot;, &quot;01/01/2009 08:51&quot;, …
## $ cal_year                      &lt;dbl&gt; 2009, 2009, 2009, 2009, 2009, 2009, 2009…
## $ fin_year                      &lt;chr&gt; &quot;2008/09&quot;, &quot;2008/09&quot;, &quot;2008/09&quot;, &quot;2008/0…
## $ type_of_incident              &lt;chr&gt; &quot;Special Service&quot;, &quot;Special Service&quot;, &quot;S…
## $ pump_count                    &lt;chr&gt; &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, …
## $ pump_hours_total              &lt;chr&gt; &quot;2&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, &quot;1&quot;, …
## $ hourly_notional_cost          &lt;dbl&gt; 255, 255, 255, 255, 255, 255, 255, 255, …
## $ incident_notional_cost        &lt;chr&gt; &quot;510&quot;, &quot;255&quot;, &quot;255&quot;, &quot;255&quot;, &quot;255&quot;, &quot;255&quot;…
## $ final_description             &lt;chr&gt; &quot;Redacted&quot;, &quot;Redacted&quot;, &quot;Redacted&quot;, &quot;Red…
## $ animal_group_parent           &lt;chr&gt; &quot;Dog&quot;, &quot;Fox&quot;, &quot;Dog&quot;, &quot;Horse&quot;, &quot;Rabbit&quot;, …
## $ originof_call                 &lt;chr&gt; &quot;Person (land line)&quot;, &quot;Person (land line…
## $ property_type                 &lt;chr&gt; &quot;House - single occupancy&quot;, &quot;Railings&quot;, …
## $ property_category             &lt;chr&gt; &quot;Dwelling&quot;, &quot;Outdoor Structure&quot;, &quot;Outdoo…
## $ special_service_type_category &lt;chr&gt; &quot;Other animal assistance&quot;, &quot;Other animal…
## $ special_service_type          &lt;chr&gt; &quot;Animal assistance involving livestock -…
## $ ward_code                     &lt;chr&gt; &quot;E05011467&quot;, &quot;E05000169&quot;, &quot;E05000558&quot;, &quot;…
## $ ward                          &lt;chr&gt; &quot;Crystal Palace &amp; Upper Norwood&quot;, &quot;Woods…
## $ borough_code                  &lt;chr&gt; &quot;E09000008&quot;, &quot;E09000008&quot;, &quot;E09000029&quot;, &quot;…
## $ borough                       &lt;chr&gt; &quot;Croydon&quot;, &quot;Croydon&quot;, &quot;Sutton&quot;, &quot;Hilling…
## $ stn_ground_name               &lt;chr&gt; &quot;Norbury&quot;, &quot;Woodside&quot;, &quot;Wallington&quot;, &quot;Ru…
## $ uprn                          &lt;chr&gt; &quot;NULL&quot;, &quot;NULL&quot;, &quot;NULL&quot;, &quot;1.00021E+11&quot;, &quot;…
## $ street                        &lt;chr&gt; &quot;Waddington Way&quot;, &quot;Grasmere Road&quot;, &quot;Mill…
## $ usrn                          &lt;chr&gt; &quot;20500146&quot;, &quot;NULL&quot;, &quot;NULL&quot;, &quot;21401484&quot;, …
## $ postcode_district             &lt;chr&gt; &quot;SE19&quot;, &quot;SE25&quot;, &quot;SM5&quot;, &quot;UB9&quot;, &quot;RM3&quot;, &quot;RM…
## $ easting_m                     &lt;chr&gt; &quot;NULL&quot;, &quot;534785&quot;, &quot;528041&quot;, &quot;504689&quot;, &quot;N…
## $ northing_m                    &lt;chr&gt; &quot;NULL&quot;, &quot;167546&quot;, &quot;164923&quot;, &quot;190685&quot;, &quot;N…
## $ easting_rounded               &lt;dbl&gt; 532350, 534750, 528050, 504650, 554650, …
## $ northing_rounded              &lt;dbl&gt; 170050, 167550, 164950, 190650, 192350, …
## $ latitude                      &lt;chr&gt; &quot;NULL&quot;, &quot;51.39095371&quot;, &quot;51.36894086&quot;, &quot;5…
## $ longitude                     &lt;chr&gt; &quot;NULL&quot;, &quot;-0.064166887&quot;, &quot;-0.161985191&quot;, …</code></pre>
<p>One of the more useful things one can do with any data set is quick counts, namely to see how many observations fall within one category. For instance, if we wanted to count the number of incidents by year, we would either use <code>group_by()... summarise()</code> or, simply <a href="https://dplyr.tidyverse.org/reference/count.html"><code>count()</code></a></p>
<pre class="r"><code>animal_rescue %&gt;% 
  dplyr::group_by(cal_year) %&gt;% 
  summarise(count=n())</code></pre>
<pre><code>## # A tibble: 13 × 2
##    cal_year count
##       &lt;dbl&gt; &lt;int&gt;
##  1     2009   568
##  2     2010   611
##  3     2011   620
##  4     2012   603
##  5     2013   585
##  6     2014   583
##  7     2015   540
##  8     2016   604
##  9     2017   539
## 10     2018   610
## 11     2019   604
## 12     2020   758
## 13     2021   726</code></pre>
<pre class="r"><code>animal_rescue %&gt;% 
  count(cal_year, name=&quot;count&quot;)</code></pre>
<pre><code>## # A tibble: 13 × 2
##    cal_year count
##       &lt;dbl&gt; &lt;int&gt;
##  1     2009   568
##  2     2010   611
##  3     2011   620
##  4     2012   603
##  5     2013   585
##  6     2014   583
##  7     2015   540
##  8     2016   604
##  9     2017   539
## 10     2018   610
## 11     2019   604
## 12     2020   758
## 13     2021   726</code></pre>
<p>Let us try to see how many incidents we have by animal group. Again, we can do this either using group_by() and summarise(), or by using count()</p>
<pre class="r"><code>animal_rescue %&gt;% 
  group_by(animal_group_parent) %&gt;% 
  summarise(count = n()) %&gt;% 
  mutate(percent = round(100*count/sum(count),2)) %&gt;% 
  arrange(desc(percent))</code></pre>
<pre><code>## # A tibble: 28 × 3
##    animal_group_parent              count percent
##    &lt;chr&gt;                            &lt;int&gt;   &lt;dbl&gt;
##  1 Cat                               3829   48.2 
##  2 Bird                              1638   20.6 
##  3 Dog                               1242   15.6 
##  4 Fox                                380    4.78
##  5 Unknown - Domestic Animal Or Pet   202    2.54
##  6 Horse                              195    2.45
##  7 Deer                               137    1.72
##  8 Unknown - Wild Animal               95    1.19
##  9 Squirrel                            71    0.89
## 10 Unknown - Heavy Livestock Animal    50    0.63
## # … with 18 more rows</code></pre>
<pre class="r"><code>animal_rescue %&gt;% 
  count(animal_group_parent, name=&quot;count&quot;, sort=TRUE) %&gt;% 
  mutate(percent = round(100*count/sum(count),2))</code></pre>
<pre><code>## # A tibble: 28 × 3
##    animal_group_parent              count percent
##    &lt;chr&gt;                            &lt;int&gt;   &lt;dbl&gt;
##  1 Cat                               3829   48.2 
##  2 Bird                              1638   20.6 
##  3 Dog                               1242   15.6 
##  4 Fox                                380    4.78
##  5 Unknown - Domestic Animal Or Pet   202    2.54
##  6 Horse                              195    2.45
##  7 Deer                               137    1.72
##  8 Unknown - Wild Animal               95    1.19
##  9 Squirrel                            71    0.89
## 10 Unknown - Heavy Livestock Animal    50    0.63
## # … with 18 more rows</code></pre>
<p>Do you see anything strange in these tables?
Cat appears twice in the tables</p>
<p>Finally, let us have a loot at the notional cost for rescuing each of these animals. As the LFB says,</p>
<blockquote>
<p>Please note that any cost included is a notional cost calculated based on the length of time rounded up to the nearest hour spent by Pump, Aerial and FRU appliances at the incident and charged at the current Brigade hourly rate.</p>
</blockquote>
<p>There is two things we will do:</p>
<ol style="list-style-type: decimal">
<li>Calculate the mean and median <code>incident_notional_cost</code> for each <code>animal_group_parent</code></li>
<li>Plot a boxplot to get a feel for the distribution of <code>incident_notional_cost</code> by <code>animal_group_parent</code>.</li>
</ol>
<p>Before we go on, however, we need to fix <code>incident_notional_cost</code> as it is stored as a <code>chr</code>, or character, rather than a number.</p>
<pre class="r"><code>typeof(animal_rescue$incident_notional_cost)</code></pre>
<pre><code>## [1] &quot;character&quot;</code></pre>
<pre class="r"><code>animal_rescue &lt;- animal_rescue %&gt;% 
  mutate(incident_notional_cost = parse_number(incident_notional_cost))</code></pre>
<p>Now tht incident_notional_cost is numeric, let us quickly calculate summary statistics for each animal group.</p>
<pre class="r"><code>animal_rescue %&gt;% 
  group_by(animal_group_parent) %&gt;% 
  filter(n()&gt;6) %&gt;% 
  summarise(mean_incident_cost = mean (incident_notional_cost, na.rm=TRUE),
            median_incident_cost = median (incident_notional_cost, na.rm=TRUE),
            sd_incident_cost = sd (incident_notional_cost, na.rm=TRUE),
            min_incident_cost = min (incident_notional_cost, na.rm=TRUE),
            max_incident_cost = max (incident_notional_cost, na.rm=TRUE),
            count = n()) %&gt;%
  arrange(desc(mean_incident_cost))</code></pre>
<pre><code>## # A tibble: 16 × 7
##    animal_group_parent      mean_incident_co… median_incident_… sd_incident_cost
##    &lt;chr&gt;                                &lt;dbl&gt;             &lt;dbl&gt;            &lt;dbl&gt;
##  1 Horse                                 740.              596             541. 
##  2 Cow                                   599.              436             451. 
##  3 Unknown - Wild Animal                 415.              333             321. 
##  4 Deer                                  415.              333             281. 
##  5 Fox                                   375.              330.            204. 
##  6 Unknown - Heavy Livesto…              374.              260             263. 
##  7 Snake                                 356.              339             105. 
##  8 Dog                                   347.              298             167. 
##  9 Cat                                   345.              326             161. 
## 10 Bird                                  344.              328             134. 
## 11 Unknown - Domestic Anim…              326.              295             116. 
## 12 cat                                   324.              290              94.1
## 13 Squirrel                              315.              328              56.0
## 14 Hamster                               315.              290              95.0
## 15 Ferret                                309.              333              39.4
## 16 Rabbit                                309.              326              32.2
## # … with 3 more variables: min_incident_cost &lt;dbl&gt;, max_incident_cost &lt;dbl&gt;,
## #   count &lt;int&gt;</code></pre>
<p>Compare the mean and the median for each animal group. waht do you think this is telling us?
Anything else that stands out? Any outliers?</p>
<ul>
<li>the mean cost is in almost all cases (except for squirrels, ferrets and rabbits) higher than the median cost. This means that in each animal group there are a few signficant outliers above the range (way more expensive than the other incidents).</li>
<li>Distribution is skewed to the right</li>
<li>Animals with the most incidents (cats, birds and dogs) have a much lower spread in costs of the incidents, mainly due to the fact that they are smaller.</li>
</ul>
<p>Finally, let us plot a few plots that show the distribution of incident_cost for each animal group.</p>
<pre class="r"><code>base_plot &lt;- animal_rescue %&gt;% 
  group_by(animal_group_parent) %&gt;% 
  filter(n()&gt;6) %&gt;% 
  ggplot(aes(x=incident_notional_cost))+
  facet_wrap(~animal_group_parent, scales = &quot;free&quot;)+
  theme_bw()

base_plot + geom_histogram()+labs(title=&quot;Incident costs by animal&quot;,x=&quot;Cost&quot;,y=&quot;Count&quot;)</code></pre>
<p><img src="/blogs/first_r_files/figure-html/plots_on_incident_cost_by_animal_group-1.png" width="672" /></p>
<pre class="r"><code>base_plot + geom_density()+labs(title=&quot;Incident costs by animal&quot;,x=&quot;Cost&quot;,y=&quot;Count&quot;)</code></pre>
<p><img src="/blogs/first_r_files/figure-html/plots_on_incident_cost_by_animal_group-2.png" width="672" /></p>
<pre class="r"><code>base_plot + geom_boxplot()+labs(title=&quot;Incident costs by animal&quot;,x=&quot;Cost&quot;,y=&quot;Count&quot;)</code></pre>
<p><img src="/blogs/first_r_files/figure-html/plots_on_incident_cost_by_animal_group-3.png" width="672" /></p>
<pre class="r"><code>base_plot + stat_ecdf(geom = &quot;step&quot;, pad = FALSE) +
  scale_y_continuous(labels = scales::percent)+labs(title=&quot;Incident costs by animal&quot;,x=&quot;Cost&quot;,y=&quot;Count&quot;)</code></pre>
<p><img src="/blogs/first_r_files/figure-html/plots_on_incident_cost_by_animal_group-4.png" width="672" /></p>
<p>Which of these four graphs do you think best communicates the variability of the <code>incident_notional_cost</code> values? Also, can you please tell some sort of story (which animals are more expensive to rescue than others, the spread of values) and speculate about the differences in the patterns.</p>
<ul>
<li>In my opinion, graphs like the histogram and the density function convey the message and variability the best, because they are straight forward to interpret.</li>
<li>A bit more advanced, but I also think that the empirical cumulative distribution function is nice to show the distribution and variability of spread of costs across different animals.However, you always have to look at the scales of the x-axis!</li>
<li>The cost of most animal incidents is strongly skewed to the right. However, in this regard, ferrets and rabbits stnd out, as they almost have a trimodal distribution (in the histogram), but on a much lower level than most other animals.</li>
<li>Generally speaking, smaller animals have lower indicent costs which makes intuitive sense.</li>
</ul>
<div id="r-markdown" class="section level2">
<h2>R Markdown</h2>
<p>This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <a href="http://rmarkdown.rstudio.com" class="uri">http://rmarkdown.rstudio.com</a>.</p>
<p>When you click the <strong>Knit</strong> button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:</p>
<pre class="r"><code>summary(cars)</code></pre>
<pre><code>##      speed           dist       
##  Min.   : 4.0   Min.   :  2.00  
##  1st Qu.:12.0   1st Qu.: 26.00  
##  Median :15.0   Median : 36.00  
##  Mean   :15.4   Mean   : 42.98  
##  3rd Qu.:19.0   3rd Qu.: 56.00  
##  Max.   :25.0   Max.   :120.00</code></pre>
</div>
<div id="including-plots" class="section level2">
<h2>Including Plots</h2>
<p>You can also embed plots, for example:</p>
<p><img src="/blogs/first_r_files/figure-html/pressure-1.png" width="672" /></p>
<p>Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.</p>
</div>
</div>
